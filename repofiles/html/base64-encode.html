<!DOCTYPE html>
<html>
<head>
<title>Base64 Encoder</title>
<style>
body { font-family: sans-serif; }
#progress { width: 300px; }
#base64 { white-space: pre-wrap; }  /* Allow line breaks in the output */
</style>
</head>
<body>

<h1>Base64 Encoder</h1>

<input type="file" id="fileInput" accept="*">
<progress id="progress" value="0" max="100"></progress>
<div id="base64"></div>

<script>
const fileInput = document.getElementById('fileInput');
const progress = document.getElementById('progress');
const base64Output = document.getElementById('base64');

fileInput.addEventListener('change', async () => {
    const file = fileInput.files[0];
    if (!file) return;

    const reader = new FileReader();
    let base64 = '';
    let totalBytesRead = 0;
    const fileSize = file.size;

    reader.onload = (e) => {
        base64 += e.target.result;
        totalBytesRead += reader.result.length;
        const percentage = Math.round((totalBytesRead / fileSize) * 100);
        progress.value = percentage;
        base64Output.textContent = base64;

        if (totalBytesRead < fileSize) {
            // Read the next chunk
            const chunkSize = 1024 * 1024; // 1MB chunk size - adjust as needed
            const startPos = totalBytesRead;
            const endPos = Math.min(totalBytesRead + chunkSize, fileSize);
            const blob = file.slice(startPos, endPos);
            reader.readAsDataURL(blob); // Use readAsDataURL for Base64 encoding
        }
    };

    //Start reading in chunks
    const chunkSize = 1024 * 1024;
    const blob = file.slice(0, chunkSize);
    reader.readAsDataURL(blob);
});
</script>

</body>
</html>
